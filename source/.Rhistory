# AGE<-AGE[-473,]
AGE<-na.omit(AGE)
medianage<-aggregate(AGE$age,by=list(AGE$`Groupe politique (abrégé)`),FUN="median")
vecteurmedianes<-medianage$x
# "Il faut sortir le NA il n'apporte aucune information et perturbe les données"
boxplotage<-ggplot(AGE, aes(x=`Groupe politique (abrégé)`,y=age, color=`Groupe politique (abrégé)`))+ geom_boxplot(show.legend = FALSE) + labs(title="Boite à moustache de l'age par parti politique",x="Parti politique",y="Age")+theme_minimal()
boxplotage
ageparparti<-aggregate(deputes$age,by=list(deputes$`Groupe politique (abrégé)`),FUN="mean")
sdageparparti<-aggregate(deputes$age,by=list(deputes$`Groupe politique (abrégé)`),FUN="sd")
sdageparparti$x=sdageparparti$x*sqrt(575/576)
ageparparti=merge(ageparparti, sdageparparti, by="Group.1")
meanage<-round(ageparparti$x.x,digits=0)
gagemoyenparparti<-ggplot(data = ageparparti, aes(x=Group.1,y=x.x, colour=Group.1))+geom_bar(stat="identity",aes(fill=Group.1),show.legend = FALSE, width=0.6)+labs(title="Age moyen par parti politique",x="Parti politique",y="Age moyen") + geom_text(aes(label=meanage),vjust=4,stat="identity",show.legend = FALSE,size=4.5,color="black")+ylim(0,70)+geom_errorbar(aes(ymin=meanage-x.y,ymax=meanage+x.y), color="black")+theme_minimal()
gagemoyenparparti
deputessanspierre <- subset(deputes, NOM!="VENTEAU")
mandatparparti<-aggregate(deputes$`Nombre de mandats`,by=list(deputes$`Groupe politique (abrégé)`),FUN="mean")
gmandatparparti<-ggplot(data = mandatparparti, aes(x=Group.1,y=x, colour=Group.1))+geom_bar(stat="identity",aes(fill=Group.1),show.legend = FALSE, width=0.6)+labs(title="Nombre de mandats moyen par parti politique",x="Parti politique",y="Nombre de mandats moyen")
gmandatparparti
mandatpartisexe<-aggregate(deputes$`Nombre de mandats`,by=list(deputes$`Groupe politique (abrégé)`,deputes$Sexe),FUN="mean")
mandatpartisexe
p <- ggplot(data=mandatpartisexe, aes(x=Group.1, y=x, fill=Group.2)) +geom_bar(stat="identity", color="black", position=position_dodge())+geom_text(aes(label=round(x,digits=2)), vjust=1.6, color="black", position = position_dodge(0.9), size=2.5) +labs(title = "Nombre de mandats moyen par parti selon le genre", x="Parti politique", y="Nombre de mandats moyen")+ theme_minimal() +scale_fill_discrete(name="Genre")
p
View(AGE)
View(agemoyen)
View(ageparparti)
View(deputes)
g1<-ggplot(deputes, aes(x=Sexe)) + geom_bar()+ theme_minimal()
g1
pie<-repartition+coord_polar("y",start=0)+ theme_minimal()
pie
graphage<-graphage + labs(title="Age AN", x ="", y = "Age")+coord_flip()+ theme_minimal()
graphage<-ggplot(deputes, aes(y=age,x=factor(1)))
graphage<- graphage+ geom_boxplot(fill="lightblue",colour="darkred",width=0.1)
graphage<-graphage + labs(title="Age AN", x ="", y = "Age")+coord_flip()+ theme_minimal()
graphage
gmandatparparti<-ggplot(data = mandatparparti, aes(x=Group.1,y=x, colour=Group.1))+geom_bar(stat="identity",aes(fill=Group.1),show.legend = FALSE, width=0.6)+labs(title="Nombre de mandats moyen par parti politique",x="Parti politique",y="Nombre de mandats moyen") + theme_minimal()
gmandatparparti
p <- ggplot(data=mandatpartisexe, aes(x=Group.1, y=x, fill=Group.2)) +geom_bar(stat="identity", color="black", position=position_dodge())+geom_text(aes(label=round(x,digits=2)), vjust=1.6, color="black", position = position_dodge(0.9), size=2.5) +labs(title = "Nombre de mandats moyen par parti selon le genre", x="Parti politique", y="Nombre de mandats moyen")+ theme_minimal() +scale_fill_discrete(name="Genre")
p
age_genre_parti<-aggregate(deputes$age,by=list(deputes$`Groupe politique (abrégé)`,deputes$Sexe),FUN="mean")
View(age_genre_parti)
sd_age_genre_parti<-aggregate(deputes$age,by=list(deputes$`Groupe politique (abrégé)`,deputes$Sexe),FUN="sd")
sd_age_genre_parti$x=sdageparparti$x*sqrt(575/576)
View(sd_age_genre_parti)
age_genre_parparti=merge(age_genre_parti, sd_age_genre_parti, by="Group.1")
age_genre_parti=merge(age_genre_parti, sd_age_genre_parti, by="Group.1")
View(age_genre_parti)
age_genre_parti<-aggregate(deputes$age,by=list(deputes$`Groupe politique (abrégé)`,deputes$Sexe),FUN="mean")
sd_age_genre_parti<-aggregate(deputes$age,by=list(deputes$`Groupe politique (abrégé)`,deputes$Sexe),FUN="sd")
sd_age_genre_parti$x=sdageparparti$x*sqrt(575/576)
View(age_genre_parti)
View(sd_age_genre_parti)
age_genre_parti<-aggregate(deputes$age,by=list(deputes$`Groupe politique (abrégé)`,deputes$Sexe),FUN="mean")
View(age_genre_parti)
q <- ggplot(data=age_genre_parti, aes(x=Group.1, y=x, fill=Group.2)) +geom_bar(stat="identity", color="black", position=position_dodge())+geom_text(aes(label=round(x,digits=2)), vjust=1.6, color="black", position = position_dodge(0.9), size=2.5) +labs(title = "Âge moyen par parti selon le genre", x="Parti politique", y="Âge moyen")+ theme_minimal() +scale_fill_discrete(name="Genre")
q
q <- ggplot(data=age_genre_parti, aes(x=Group.1, y=x, fill=Group.2)) +geom_bar(stat="identity", color="black", position=position_dodge())+geom_text(aes(label=round(x)), vjust=1.6, color="black", position = position_dodge(0.9), size=2.5) +labs(title = "Âge moyen par parti selon le genre", x="Parti politique", y="Âge moyen")+ theme_minimal() +scale_fill_discrete(name="Genre")
q
sdmandatparparti<-aggregate(deputes$`Nombre de mandats`,by=list(deputes$`Groupe politique (abrégé)`),FUN="sd")
View(sdmandatparparti)
sdmandatparparti$x=sdmandatparparti$x*sqrt(575/576)
mandatparparti=merge(mandatparparti, sdmandatparparti, by="Group.1")
View(mandatparparti)
meanmandat<-round(mandatparparti$x.x,digits=2)
gmandatparparti<-ggplot(data = mandatparparti, aes(x=Group.1,y=x.x, colour=Group.1))+geom_bar(stat="identity",aes(fill=Group.1),show.legend = FALSE, width=0.6)+labs(title="Nombre de mandats moyen par parti politique",x="Parti politique",y="Nombre de mandats moyen") + theme_minimal()+geom_errorbar(aes(ymin=meanmandat-x.y,ymax=meanage+x.y), color="black")+theme_minimal()
gmandatparparti
gmandatparparti<-ggplot(data = mandatparparti, aes(x=Group.1,y=x.x, colour=Group.1))+geom_bar(stat="identity",aes(fill=Group.1),show.legend = FALSE, width=0.6)+labs(title="Nombre de mandats moyen par parti politique",x="Parti politique",y="Nombre de mandats moyen") + theme_minimal()+geom_errorbar(aes(ymin=meanmandat-x.y,ymax=meanmandat+x.y), color="black")+theme_minimal()
gmandatparparti
summary(deputes$age)
graphage
sd(deputes$age)
summary(deputes$age)
sd(deputes$age)
sd(deputes$age)*sqrt(575/576)
graphage<- graphage+ geom_boxplot(fill="lightblue",colour="black",width=0.5)
graphage<-graphage + labs(title="Répartition des âges le l'Assemblée Nationale", x ="", y = "Age")+coord_flip()+ theme_minimal()
graphage
graphage<- graphage+ geom_boxplot(fill="rainbow",colour="black",width=0.5)
graphage<-graphage + labs(title="Répartition des âges le l'Assemblée Nationale", x ="", y = "Age")+coord_flip()+ theme_minimal()
graphage
graphage<- graphage+ geom_boxplot(fill="lightpink",colour="black",width=0.5)
graphage<-graphage + labs(title="Répartition des âges le l'Assemblée Nationale", x ="", y = "Age")+coord_flip()+ theme_minimal()
graphage
graphage<- graphage+ geom_boxplot(fill="lightpink",colour="black",width=0.5)
graphage<-graphage + labs(title="Répartition des âges le l'Assemblée Nationale", x ="", y = "Age")+coord_flip()+ theme_minimal()
graphage
graphage<- graphage+ geom_boxplot(fill="lightblue",colour="black",width=0.5)
graphage<-graphage + labs(title="Répartition des âges le l'Assemblée Nationale", x ="", y = "Age")+coord_flip()+ theme_minimal()
graphage
knitr::opts_chunk$set(echo = TRUE)
library(scales)
library(xlsx)
library(questionr)
library(readxl)
library(ggplot2)
deputestable1<-read_excel("../datasets/deputes_table1net.xlsx")
deputestable2<-read_excel("../datasets/deputes_table2.xlsx")
deputestable3<-read_excel("../datasets/deputes_table3.xlsx")
deputestable4<-read_excel("../datasets/deputes_table4net.xlsx")
# "On récupère le genre, il n y a que 573 deputes dont le genre est renseigne"
genre_deputes<-read_excel("../datasets/genre_deputes2.xlsx")
Titre<-genre_deputes$Titre<-paste(genre_deputes$Prénom,genre_deputes$Nom,sep=" ")
Titre<-deputestable1$Titre<-paste(deputestable1$Prénom,deputestable1$Nom_Propre,sep=" ")
deputestable1$Titre<-toupper(deputestable1$Titre)
deputestable2$Titre<-toupper(deputestable2$Titre)
deputestable3$Titre<-toupper(deputestable3$Titre)
genre_deputes$Titre<-toupper(genre_deputes$Titre)
deputes<-merge(deputestable2,deputestable3, by="Titre")
deputes<-merge(deputes,deputestable1, by="Titre",all.x = TRUE)
deputes<-merge(deputes,genre_deputes, by="Titre",all.x = TRUE)
"On enlève les prenoms et noms en trop."
deputes<-deputes[,-c(4,18,19,27,28)]
table(deputes$Sexe)
g1<-ggplot(deputes, aes(x=Sexe)) + geom_bar()+ theme_minimal()
g1
Parti<-deputes$`Groupe politique (abrégé)`
tableau<-table(Parti)
tableau<-data.frame(tableau)
repartition<-ggplot(tableau,aes(x="sieges",y=Freq, fill=Parti))+geom_bar(width = 1,stat="identity")
pie<-repartition+coord_polar("y",start=0)+ theme_minimal()
pie
"Je voudrai faire un graphique sur la frequence de premier mandat par partie politique"
age<-c(rep(2019,576))
deputes<-cbind(deputes,age)
deputes$age<-deputes$age-deputes$`Date de naissance`
agemoyen= aggregate(deputes$age,by = list(deputes$`Groupe politique (abrégé)`),FUN="mean",na.rm=FALSE, na.action=na.pass)
graphage<-ggplot(deputes, aes(y=age,x=factor(1)))
graphage<- graphage+ geom_boxplot(fill="lightblue",colour="black",width=0.5)
graphage<-graphage + labs(title="Répartition des âges le l'Assemblée Nationale", x ="", y = "Age")+coord_flip()+ theme_minimal()
graphage
summary(deputes$age)
sd(deputes$age)*sqrt(575/576)
AGE<-deputes[,c(22,24)]
# AGE<-AGE[-473,]
AGE<-na.omit(AGE)
medianage<-aggregate(AGE$age,by=list(AGE$`Groupe politique (abrégé)`),FUN="median")
vecteurmedianes<-medianage$x
# "Il faut sortir le NA il n'apporte aucune information et perturbe les données"
boxplotage<-ggplot(AGE, aes(x=`Groupe politique (abrégé)`,y=age, color=`Groupe politique (abrégé)`))+ geom_boxplot(show.legend = FALSE) + labs(title="Boite à moustache de l'age par parti politique",x="Parti politique",y="Age")+theme_minimal()
boxplotage
ageparparti<-aggregate(deputes$age,by=list(deputes$`Groupe politique (abrégé)`),FUN="mean")
sdageparparti<-aggregate(deputes$age,by=list(deputes$`Groupe politique (abrégé)`),FUN="sd")
sdageparparti$x=sdageparparti$x*sqrt(575/576)
ageparparti=merge(ageparparti, sdageparparti, by="Group.1")
meanage<-round(ageparparti$x.x,digits=0)
gagemoyenparparti<-ggplot(data = ageparparti, aes(x=Group.1,y=x.x, colour=Group.1))+geom_bar(stat="identity",aes(fill=Group.1),show.legend = FALSE, width=0.6)+labs(title="Age moyen par parti politique",x="Parti politique",y="Age moyen") + geom_text(aes(label=meanage),vjust=4,stat="identity",show.legend = FALSE,size=4.5,color="black")+ylim(0,70)+geom_errorbar(aes(ymin=meanage-x.y,ymax=meanage+x.y), color="black")+theme_minimal()
gagemoyenparparti
deputessanspierre <- subset(deputes, NOM!="VENTEAU")
mandatparparti<-aggregate(deputes$`Nombre de mandats`,by=list(deputes$`Groupe politique (abrégé)`),FUN="mean")
sdmandatparparti<-aggregate(deputes$`Nombre de mandats`,by=list(deputes$`Groupe politique (abrégé)`),FUN="sd")
sdmandatparparti$x=sdmandatparparti$x*sqrt(574/575)
mandatparparti=merge(mandatparparti, sdmandatparparti, by="Group.1")
meanmandat<-round(mandatparparti$x.x,digits=2)
gmandatparparti<-ggplot(data = mandatparparti, aes(x=Group.1,y=x.x, colour=Group.1))+geom_bar(stat="identity",aes(fill=Group.1),show.legend = FALSE, width=0.6)+labs(title="Nombre de mandats moyen par parti politique",x="Parti politique",y="Nombre de mandats moyen") + theme_minimal()+geom_errorbar(aes(ymin=meanmandat-x.y,ymax=meanmandat+x.y), color="black")+theme_minimal()
gmandatparparti
age_genre_parti<-aggregate(deputes$age,by=list(deputes$`Groupe politique (abrégé)`,deputes$Sexe),FUN="mean")
q <- ggplot(data=age_genre_parti, aes(x=Group.1, y=x, fill=Group.2)) +geom_bar(stat="identity", color="black", position=position_dodge())+geom_text(aes(label=round(x)), vjust=1.6, color="black", position = position_dodge(0.9), size=2.5) +labs(title = "Âge moyen par parti selon le genre", x="Parti politique", y="Âge moyen")+ theme_minimal() +scale_fill_discrete(name="Genre")
q
mandatpartisexe<-aggregate(deputes$`Nombre de mandats`,by=list(deputes$`Groupe politique (abrégé)`,deputes$Sexe),FUN="mean")
p <- ggplot(data=mandatpartisexe, aes(x=Group.1, y=x, fill=Group.2)) +geom_bar(stat="identity", color="black", position=position_dodge())+geom_text(aes(label=round(x,digits=2)), vjust=1.6, color="black", position = position_dodge(0.9), size=2.5) +labs(title = "Nombre de mandats moyen par parti selon le genre", x="Parti politique", y="Nombre de mandats moyen")+ theme_minimal() +scale_fill_discrete(name="Genre")
p
View(deputes)
gausstest= ggplot(deputes, aes(deputes$age))+geom_density(kernel="gaussian")
gausstest
gausstest
gausstest= ggplot(deputes, aes(deputes$age))+geom_density(kernel="gaussian") +geom_vline(aes(xintercept=mean(deputes$age)),color="blue", linetype="dashed", size=1) labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")
gausstest= ggplot(deputes, aes(deputes$age))+geom_density(kernel="gaussian") +geom_vline(aes(xintercept=mean(deputes$age)),color="blue", linetype="dashed", size=1)+ labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")
gausstest
gausstest= ggplot(deputes, aes(deputes$age,color=deputes$Sexe))+geom_density(kernel="gaussian") +geom_vline(aes(xintercept=mean(deputes$age)),color="blue", linetype="dashed", size=1)+ labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")
gausstest
gausstest= ggplot(deputes, aes(deputes$age,color=deputes$Sexe))+geom_density(kernel="gaussian", na.omit) +geom_vline(aes(xintercept=mean(deputes$age)),color="blue", linetype="dashed", size=1)+ labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")
gausstest= ggplot(deputes, aes(deputes$age,color=deputes$Sexe))+geom_density(kernel="gaussian", aes(na.omit)) +geom_vline(aes(xintercept=mean(deputes$age)),color="blue", linetype="dashed", size=1)+ labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")
gausstest
gausstest= ggplot(deputes, aes(deputes$age,color=deputes$Sexe))+geom_density(kernel="gaussian") +geom_vline(aes(xintercept=mean(deputes$age)),color="blue", linetype="dashed", size=1)+ labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")
gausstest
gausstest= ggplot(deputes, aes(deputes$age,color=deputes$Sexe,na.action=na.omit))+geom_density(kernel="gaussian") +geom_vline(aes(xintercept=mean(deputes$age)),color="blue", linetype="dashed", size=1)+ labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")
gausstest
gausstest= ggplot(deputes, aes(deputes$age,color=deputes$Sexe))+geom_density(kernel="gaussian") +geom_vline(aes(xintercept=mean(deputes$age)),color="blue", linetype="dashed", size=1)+ labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")
gausstest
gausstest= ggplot(deputes, aes(deputes$age,color=deputes$Sexe))+geom_density(kernel="gaussian") +geom_vline(aes(xintercept=mean(deputes$age)),color="blue", linetype="dashed", size=1)+ labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")
gausstest
gausstest= ggplot(deputes, aes(deputes$age,color=deputes$Sexe))+geom_density(kernel="gaussian") +geom_vline(aes(xintercept=mean(deputes$age)),color="blue", linetype="dashed", size=1)+ labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")+scale_fill_discrete(name="Genre")
gausstest
gausstest= ggplot(subset(deputes,!is.na(age)), aes(deputes$age,color=deputes$Sexe))+geom_density(kernel="gaussian") +geom_vline(aes(xintercept=mean(deputes$age)),color="blue", linetype="dashed", size=1)+ labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")+scale_fill_discrete(name="Genre")
gausstest
gausstest= ggplot(data=subset(deputes,!is.na(age)), aes(deputes$age,color=deputes$Sexe))+geom_density(kernel="gaussian") +geom_vline(aes(xintercept=mean(deputes$age)),color="blue", linetype="dashed", size=1)+ labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")+scale_fill_discrete(name="Genre")
gausstest
gausstest= ggplot(data=subset(deputes,!is.na(deputes$age)), aes(deputes$age,color=deputes$Sexe))+geom_density(kernel="gaussian") +geom_vline(aes(xintercept=mean(deputes$age)),color="blue", linetype="dashed", size=1)+ labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")+scale_fill_discrete(name="Genre")
gausstest
gausstest= ggplot(data=subset(deputes,!is.na(Sexe)), aes(deputes$age,color=deputes$Sexe))+geom_density(kernel="gaussian") +geom_vline(aes(xintercept=mean(deputes$age)),color="blue", linetype="dashed", size=1)+ labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")+scale_fill_discrete(name="Genre")
gausstest
AGEGENRE<-deputes[,c(23,24)]
AGEGENRE<-na.omit(AGEGENRE)
mu<-ddply(AGEGENRE,"Sexe",summarise,grp.mean=mean(age))
library(ddply)
install.packages("ddply")
View(AGEGENRE)
gausstest= ggplot(data=AGEGENRE, aes(AGEGENRE$age,color=AGEGENRE$Sexe))+geom_density(kernel="gaussian") +geom_vline(aes(xintercept=mean(AGEGENRE$age)),color="blue", linetype="dashed", size=1)+ labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")+scale_fill_discrete(name="Genre")
gausstest
library(plyr)
mu<-ddply(AGEGENRE,"Sexe",summarise,grp.mean=mean(age))
head(mu)
gausstest= ggplot(AGEGENRE, aes(x=age, color=Sexe))+geom_density()+geom_vline(data=mu, aes(xintercept=grp.mean, color=Sexe), linetype="dashed")
gausstest
gausstest= ggplot(AGEGENRE, aes(x=age, color=Sexe))+geom_density()+geom_vline(data=mu, aes(xintercept=grp.mean, color=Sexe), linetype="dashed")labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")+scale_fill_discrete(name="Genre")
gausstest= ggplot(AGEGENRE, aes(x=age, color=Sexe))+geom_density()+geom_vline(data=mu, aes(xintercept=grp.mean, color=Sexe), linetype="dashed")+labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")+scale_fill_discrete(name="Genre")
gausstest
gausstest= ggplot(AGEGENRE, aes(x=age, color=Sexe))+geom_density()+geom_vline(data=mu, aes(xintercept=grp.mean, color=Sexe), linetype="dashed")+labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")
gausstest
gausstest= ggplot(AGEGENRE, aes(x=age, color=Sexe))+geom_density()+geom_vline(data=mu, aes(xintercept=grp.mean, color=Sexe), linetype="dashed")+labs(title="Distribution de l'âge des députés", x="Âge des députés", y="Densité")+theme_minimal()
gausstest
sd(deputes$age)*sqrt(575/576)
bornemin=mean(deputes$age)-2*11.04
bornemax=mean(deputes$age)+2*11.04
bornemin, bornemax
View(bornemin,bornemax)
bornemin
bornemax
graphage<-ggplot(deputes, aes(y=age,x=factor(1)))
graphage<- graphage+ geom_boxplot(fill="white",colour="black",width=0.1)
graphage<-graphage + labs(title="Age AN", x ="", y = "Age")+coord_flip() + theme_minimal() +ylim(20,80)
graphage
AGEGENRE<-deputes[,c(23,24)]
AGEGENRE<-na.omit(AGEGENRE)
mu<-ddply(AGEGENRE,"Sexe",summarise,grp.mean=mean(age))
head(mu)
gausstest= ggplot(AGEGENRE, aes(x=age, color=Sexe))+geom_density()+geom_vline(data=mu, aes(xintercept=grp.mean, color=Sexe), linetype="dashed")+theme_minimal()+xlim(10,90)
gausstest2= ggplot(AGEGENRE, aes(x=age))+geom_density()+theme_minimal()+geom_vline(data=AGEGENRE, aes(xintercept=median(age)))+geom_vline(data=AGEGENRE, aes(xintercept=mean(age)),color="blue",linetype="dashed")+xlim(10, 90)
graphage
gausstest2
gausstest
graphage
g1
table(subset(deputes$Sexe, !is.na(Sexe)))
table(subset(deputes$Sexe, !is.na(deputes$Sexe)))
g1<-ggplot(subset(deputes$Sexe, !is.na(deputes$Sexe)), aes(x=Sexe)) + geom_bar()+ theme_minimal()
tab1=table(subset(deputes$Sexe, !is.na(deputes$Sexe)))
tab1=as.data.frame(tab1)
View(tab1)
g1<-ggplot(tab1, aes(x=Var1)) + geom_bar()+ theme_minimal()
g1
View(tab1)
g1<-ggplot(tab1, aes(x=Var1, y=Freq)) + geom_bar()+ theme_minimal()
g1
g1<-ggplot(tab1, aes(x=Var1, y=Freq)) + geom_bar(stats=identity)+ theme_minimal()
g1<-ggplot(tab1, aes(x=Var1, y=Freq)) + geom_bar(stats=identity)+ theme_minimal()
g1<-ggplot(tab1, aes(x=Var1) + geom_bar(stats=identity)+ theme_minimal()
tab1=table(subset(deputes$Sexe, !is.na(deputes$Sexe)))
g1<-ggplot(tab1, aes(x=Var1)) + geom_bar(stats=identity)+ theme_minimal()
g1
g1<-ggplot(tab1)
g1
g1<-ggplot(tab1)+geom_bar()
g1
Parti<-deputes$`Groupe politique (abrégé)`
Parti<-na.omit(Parti)
table(Parti)
freq(Parti)
Partifreq.data<-data.frame(Partis=c("FI","GDR","LaREM","LR","LT","MODEM","NI","SOC","UDI-AGIR"),n=c(17,16,303,104,19,46,13,29,28),prop=c(3,2.8,52.7,18.1,3.3,8.0,2.3,5.0,4.9))
Partifreq.data
Partifreq.data<-Partifreq.data%>%arrange(desc(Partis))%>%mutate(lab.ypos=cumsum(prop)-0.5*prop)
install.packages("dplyr")
install.packages("dplyr")
library(dplyr)
knitr::opts_chunk$set(echo = TRUE)
library(scales)
library(xlsx)
library(questionr)
library(readxl)
library(ggplot2)
library(plyr)
library(dplyr)
deputestable1<-read_excel("../datasets/deputes_table1net.xlsx")
deputestable2<-read_excel("../datasets/deputes_table2.xlsx")
deputestable3<-read_excel("../datasets/deputes_table3.xlsx")
deputestable4<-read_excel("../datasets/deputes_table4net.xlsx")
# "On récupère le genre, il n y a que 573 deputes dont le genre est renseigne"
genre_deputes<-read_excel("../datasets/genre_deputes2.xlsx")
Titre<-genre_deputes$Titre<-paste(genre_deputes$Prénom,genre_deputes$Nom,sep=" ")
Titre<-deputestable1$Titre<-paste(deputestable1$Prénom,deputestable1$Nom_Propre,sep=" ")
deputestable1$Titre<-toupper(deputestable1$Titre)
deputestable2$Titre<-toupper(deputestable2$Titre)
deputestable3$Titre<-toupper(deputestable3$Titre)
genre_deputes$Titre<-toupper(genre_deputes$Titre)
deputes<-merge(deputestable2,deputestable3, by="Titre")
deputes<-merge(deputes,deputestable1, by="Titre",all.x = TRUE)
deputes<-merge(deputes,genre_deputes, by="Titre",all.x = TRUE)
"On enlève les prenoms et noms en trop."
deputes<-deputes[,-c(4,18,19,27,28)]
Parti<-deputes$`Groupe politique (abrégé)`
Parti<-na.omit(Parti)
table(Parti)
freq(Parti)
Partifreq.data<-data.frame(Partis=c("FI","GDR","LaREM","LR","LT","MODEM","NI","SOC","UDI-AGIR"),n=c(17,16,303,104,19,46,13,29,28),prop=c(3,2.8,52.7,18.1,3.3,8.0,2.3,5.0,4.9))
Partifreq.data
Partifreq.data<-Partifreq.data%>%arrange(desc(Partis))%>%mutate(lab.ypos=cumsum(prop)-0.5*prop)
Partifreq.data
graph<-ggplot(Partifreq.data, aes(x=2,y=prop,fill=Partis))+geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+ geom_text(aes(y = lab.ypos, label = prop), color = "black")+theme_void()+xlim(0.5,2.5)
graph
g1<-ggplot(deputes, aes(x=Sexe)) + geom_bar()
g1
age<-c(rep(2019,576))
deputes<-cbind(deputes,age)
deputes$age<-deputes$age-deputes$`Date de naissance`
agemoyen= aggregate(deputes$age,by = list(deputes$`Groupe politique (abrégé)`),FUN="mean",na.rm=FALSE, na.action=na.pass)
summary(deputes$age)
sd(deputes$age)*sqrt(575/576)
graphage<-ggplot(deputes, aes(y=age,x=factor(1)))
graphage<- graphage+ geom_boxplot(fill="white",colour="black",width=0.1)
graphage<-graphage + labs(title="Répartition des âges le l'Assemblée Nationale", x ="", y = "Age")+ theme_minimal() +ylim(20,80)+coord_flip()
AGEGENRE<-deputes[,c(23,24)]
AGEGENRE<-na.omit(AGEGENRE)
mu<-ddply(AGEGENRE,"Sexe",summarise,grp.mean=mean(age))
gausstest= ggplot(AGEGENRE, aes(x=age, color=Sexe))+geom_density()+geom_vline(data=mu, aes(xintercept=grp.mean, color=Sexe), linetype="dashed")+theme_minimal()+xlim(10,90)
gausstest2= ggplot(AGEGENRE, aes(x=age))+geom_density()+theme_minimal()+geom_vline(data=AGEGENRE, aes(xintercept=median(age)))+geom_vline(data=AGEGENRE, aes(xintercept=mean(age)),color="blue",linetype="dashed")+xlim(10, 90)
graphage
gausstest2
gausstest
AGE<-deputes[,c(22,24)]
# AGE<-AGE[-473,]
AGE<-na.omit(AGE)
medianage<-aggregate(AGE$age,by=list(AGE$`Groupe politique (abrégé)`),FUN="median")
vecteurmedianes<-medianage$x
# "Il faut sortir le NA il n'apporte aucune information et perturbe les données"
boxplotage<-ggplot(AGE, aes(x=`Groupe politique (abrégé)`,y=age, color=`Groupe politique (abrégé)`))+ geom_boxplot(show.legend = FALSE) + labs(title="Boite à moustache de l'age par parti politique",x="Parti politique",y="Age")+theme_minimal()
boxplotage
ageparparti<-aggregate(deputes$age,by=list(deputes$`Groupe politique (abrégé)`),FUN="mean")
sdageparparti<-aggregate(deputes$age,by=list(deputes$`Groupe politique (abrégé)`),FUN="sd")
sdageparparti$x=sdageparparti$x*sqrt(575/576)
ageparparti=merge(ageparparti, sdageparparti, by="Group.1")
meanage<-round(ageparparti$x.x,digits=0)
gagemoyenparparti<-ggplot(data = ageparparti, aes(x=Group.1,y=x.x, colour=Group.1))+geom_bar(stat="identity",aes(fill=Group.1),show.legend = FALSE, width=0.6)+labs(title="Age moyen par parti politique",x="Parti politique",y="Age moyen") + geom_text(aes(label=meanage),vjust=4,stat="identity",show.legend = FALSE,size=4.5,color="black")+ylim(0,70)+geom_errorbar(aes(ymin=meanage-x.y,ymax=meanage+x.y), color="black")+theme_minimal()
gagemoyenparparti
deputessanspierre <- subset(deputes, NOM!="VENTEAU")
mandatparparti<-aggregate(deputes$`Nombre de mandats`,by=list(deputes$`Groupe politique (abrégé)`),FUN="mean")
sdmandatparparti<-aggregate(deputes$`Nombre de mandats`,by=list(deputes$`Groupe politique (abrégé)`),FUN="sd")
sdmandatparparti$x=sdmandatparparti$x*sqrt(574/575)
mandatparparti=merge(mandatparparti, sdmandatparparti, by="Group.1")
meanmandat<-round(mandatparparti$x.x,digits=2)
gmandatparparti<-ggplot(data = mandatparparti, aes(x=Group.1,y=x.x, colour=Group.1))+geom_bar(stat="identity",aes(fill=Group.1),show.legend = FALSE, width=0.6)+labs(title="Nombre de mandats moyen par parti politique",x="Parti politique",y="Nombre de mandats moyen") + theme_minimal()+geom_errorbar(aes(ymin=meanmandat-x.y,ymax=meanmandat+x.y), color="black")+theme_minimal()
gmandatparparti
age_genre_parti<-aggregate(deputes$age,by=list(deputes$`Groupe politique (abrégé)`,deputes$Sexe),FUN="mean")
q <- ggplot(data=age_genre_parti, aes(x=Group.1, y=x, fill=Group.2)) +geom_bar(stat="identity", color="black", position=position_dodge())+geom_text(aes(label=round(x)), vjust=1.6, color="black", position = position_dodge(0.9), size=2.5) +labs(title = "Âge moyen par parti selon le genre", x="Parti politique", y="Âge moyen")+ theme_minimal() +scale_fill_discrete(name="Genre")
q
mandatpartisexe<-aggregate(deputes$`Nombre de mandats`,by=list(deputes$`Groupe politique (abrégé)`,deputes$Sexe),FUN="mean")
p <- ggplot(data=mandatpartisexe, aes(x=Group.1, y=x, fill=Group.2)) +geom_bar(stat="identity", color="black", position=position_dodge())+geom_text(aes(label=round(x,digits=2)), vjust=1.6, color="black", position = position_dodge(0.9), size=2.5) +labs(title = "Nombre de mandats moyen par parti selon le genre", x="Parti politique", y="Nombre de mandats moyen")+ theme_minimal() +scale_fill_discrete(name="Genre")
p
graph
g1<-ggplot(deputes, aes(x=Sexe)) + geom_bar()+scale_fill_manual(values=c('black','lightgray'))
g1
g1<-ggplot(deputes, aes(x=Sexe)) + geom_bar()+scale_fill_manual(values=c('black','lightgray',"red"))
g1
g1<-ggplot(deputes, aes(x=Sexe)) + geom_bar() + scale_fill_manual(values=c('black','lightgray',"red"))
g1
g1<-ggplot(deputes, aes(x=Sexe)) + geom_bar() + scale_fill_manual(values=c('black','lightgray',"red")) + theme_minimal()
g1
g1<-ggplot(deputes, aes(x=Sexe)) + geom_bar() + scale_fill_brewer(palette="Greens")) + theme_minimal()
g1<-ggplot(deputes, aes(x=Sexe)) + geom_bar() + scale_fill_brewer(palette="Greens") + theme_minimal()
g1
g1<-ggplot(deputes, aes(x=Sexe))+ geom_bar() + scale_fill_brewer(palette="Greens") + theme_minimal()
g1
g1 = g1 + scale_fill_brewer(palette="Greens") + theme_minimal()
g1<-ggplot(deputes, aes(x=Sexe))+ geom_bar()  + theme_minimal()
g1
g1 = g1 + scale_fill_brewer(palette="Greens") + theme_minimal()
g1
g1<-ggplot(deputes, aes(x=Sexe))+ geom_bar(color="blue")  + theme_minimal()
g
g1
g1<-ggplot(deputes, aes(x=Sexe))+ geom_bar(fill="blue")  + theme_minimal()
g1
g1<-ggplot(deputes, aes(x=Sexe, color=Sexe))+ geom_bar()  + theme_minimal()
g1
g1<-ggplot(deputes, aes(x=Sexe, fill=Sexe))+ geom_bar()  + theme_minimal()
g1
g1<-ggplot(deputes, aes(x=Sexe, color="black",fill=Sexe))+ geom_bar() + theme_minimal()
g1
g1<-ggplot(deputes, aes(x=Sexe,fill=Sexe))+ geom_bar(color="black") + theme_minimal()
g1
g1<-ggplot(deputes, aes(x=Sexe,fill=Sexe))+ geom_bar(color="black") + theme_minimal() + geom_text(aes(label="identity"))
g1
g1<-ggplot(deputes, aes(x=Sexe,fill=Sexe))+ geom_bar(color="black") + theme_minimal() + geom_text(aes(label=Sexe))
g1
g1<-ggplot(deputes, aes(x=Sexe,fill=Sexe))+ geom_bar(color="black") + geom_text(aes(label=count), vjust=-0.3, size=3.5)theme_minimal()
g1<-ggplot(deputes, aes(x=Sexe,fill=Sexe))+ geom_bar(color="black") + geom_text(aes(label=count), vjust=-0.3, size=3.5)+theme_minimal()
g1
g1<-ggplot(deputes, aes(x=Sexe,fill=Sexe))+ geom_bar(color="black") + geom_text(aes(label="count"), vjust=-0.3, size=3.5)+theme_minimal()
g1
g1<-ggplot(deputes, aes(x=Sexe,fill=Sexe))+ geom_bar(color="black") + geom_text(aes(label=bin), vjust=-0.3, size=3.5)+theme_minimal()
g1
g1<-ggplot(deputes, aes(x=Sexe,fill=Sexe))+ geom_bar(color="black") + geom_text(aes(label="bin"), vjust=-0.3, size=3.5)+theme_minimal()
g1
g1<-ggplot(deputes, aes(x=Sexe,fill=Sexe))+ geom_bar(color="black")+theme_minimal()
g1
tab(deputes$Sexe)
tabulate(deputes$Sexe)
table(deputes$Sexe)
testchiant=as.data.frame(table(deputes$Sexe))
View(testchiant)
gchiant<-ggplot(testchiant, aes(x=Var1, y=Freq,fill=Sexe))+ geom_bar(color="black")+theme_minimal()
gchiant
gchiant<-ggplot(testchiant, aes(x=Var1, y=Freq,fill=Var1))+ geom_bar(color="black")+theme_minimal()
gchiant
gchiant<-ggplot(testchiant, aes(x=Var1, y=Freq,fill=Var1))+ geom_bar(stats="identity",color="black")+theme_minimal()
gchiant<-ggplot(testchiant, aes(x=Var1, y=Freq,fill=Var1))+ geom_bar(stat="identity",color="black")+theme_minimal()
gchiant
gchiant<-ggplot(testchiant, aes(x=Var1, y=Freq,fill=Var1))+ geom_bar(stat="identity",color="black")+geom_text(aes(label=Freq))+theme_minimal()
gchiant
View(testchiant)
table(deputes$Sexe)
help(table)
testchiant=as.data.frame(table(deputes$Sexe,"always"))
testchiant=as.data.frame(table(deputes$Sexe,"ifany"))
table(deputes$Sexe,"ifany")
table(deputes$Sexe,useNA = "ifany")
testchiant=as.data.frame(table(deputes$Sexe,useNA="ifany"))
gchiant<-ggplot(testchiant, aes(x=Var1, y=Freq,fill=Var1))+ geom_bar(stat="identity",color="black")+geom_text(aes(label=Freq))+theme_minimal()
gchiant
gchiant<-ggplot(testchiant, aes(x=Var1, y=Freq,fill=Var1))+ geom_bar(stat="identity",color="black")+geom_text(aes(label=Freq), vjust=2)+theme_minimal()
gchiant
gchiant<-ggplot(testchiant, aes(x=Var1, y=Freq,fill=Var1))+ geom_bar(stat="identity",color="black")+geom_text(aes(label=Freq), vjust=-0.5)+theme_minimal()
gchiant
gchiant<-ggplot(testchiant, aes(x=Var1, y=Freq,fill=Var1))+ geom_bar(stat="identity",color="black")+geom_text(aes(label=Freq), vjust=1)+theme_minimal()
gchiant
gchiant<-ggplot(testchiant, aes(x=Var1, y=Freq,fill=Var1))+ geom_bar(stat="identity",color="black")+geom_text(aes(label=Freq), vjust=1.5)+theme_minimal()
gchiant
tabtemp=as.data.frame(table(deputes$Sexe,useNA="ifany"))
g1<-ggplot(tabtemp, aes(x=Var1, y=Freq,fill=Var1))+ geom_bar(stat="identity",color="black")+geom_text(aes(label=Freq), vjust=1.5)+theme_minimal()
g1
knitr::opts_chunk$set(echo = TRUE)
library(scales)
library(xlsx)
library(questionr)
library(readxl)
library(ggplot2)
library(plyr)
library(dplyr)
deputestable1<-read_excel("../datasets/deputes_table1net.xlsx")
deputestable2<-read_excel("../datasets/deputes_table2.xlsx")
deputestable3<-read_excel("../datasets/deputes_table3.xlsx")
deputestable4<-read_excel("../datasets/deputes_table4net.xlsx")
# "On récupère le genre, il n y a que 573 deputes dont le genre est renseigne"
genre_deputes<-read_excel("../datasets/genre_deputes2.xlsx")
Titre<-genre_deputes$Titre<-paste(genre_deputes$Prénom,genre_deputes$Nom,sep=" ")
Titre<-deputestable1$Titre<-paste(deputestable1$Prénom,deputestable1$Nom_Propre,sep=" ")
deputestable1$Titre<-toupper(deputestable1$Titre)
deputestable2$Titre<-toupper(deputestable2$Titre)
deputestable3$Titre<-toupper(deputestable3$Titre)
genre_deputes$Titre<-toupper(genre_deputes$Titre)
deputes<-merge(deputestable2,deputestable3, by="Titre")
deputes<-merge(deputes,deputestable1, by="Titre",all.x = TRUE)
deputes<-merge(deputes,genre_deputes, by="Titre",all.x = TRUE)
"On enlève les prenoms et noms en trop."
deputes<-deputes[,-c(4,18,19,27,28)]
Parti<-deputes$`Groupe politique (abrégé)`
Parti<-na.omit(Parti)
Partifreq.data<-data.frame(Partis=c("FI","GDR","LaREM","LR","LT","MODEM","NI","SOC","UDI-AGIR"),n=c(17,16,303,104,19,46,13,29,28),prop=c(3,2.8,52.7,18.1,3.3,8.0,2.3,5.0,4.9))
Partifreq.data
Partifreq.data<-Partifreq.data%>%arrange(desc(Partis))%>%mutate(lab.ypos=cumsum(prop)-0.5*prop)
graph<-ggplot(Partifreq.data, aes(x=2,y=prop,fill=Partis))+geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0)+ geom_text(aes(y = lab.ypos, label = prop), color = "black")+theme_void()+xlim(0.5,2.5)
graph
tabtemp=as.data.frame(table(deputes$Sexe,useNA="ifany"))
g1<-ggplot(tabtemp, aes(x=Var1, y=Freq,fill=Var1))+ geom_bar(stat="identity",color="black")+geom_text(aes(label=Freq), vjust=1.5)+theme_minimal()
g1
age<-c(rep(2019,576))
deputes<-cbind(deputes,age)
deputes$age<-deputes$age-deputes$`Date de naissance`
agemoyen= aggregate(deputes$age,by = list(deputes$`Groupe politique (abrégé)`),FUN="mean",na.rm=FALSE, na.action=na.pass)
summary(deputes$age)
sd(deputes$age)*sqrt(575/576)
graphage<-ggplot(deputes, aes(y=age,x=factor(1)))
graphage<- graphage+ geom_boxplot(fill="white",colour="black",width=0.1)
graphage<-graphage + labs(title="Répartition des âges le l'Assemblée Nationale", x ="", y = "Age")+ theme_minimal() +ylim(20,80)+coord_flip()
AGEGENRE<-deputes[,c(23,24)]
AGEGENRE<-na.omit(AGEGENRE)
mu<-ddply(AGEGENRE,"Sexe",summarise,grp.mean=mean(age))
gausstest= ggplot(AGEGENRE, aes(x=age, color=Sexe))+geom_density()+geom_vline(data=mu, aes(xintercept=grp.mean, color=Sexe), linetype="dashed")+theme_minimal()+xlim(10,90)
gausstest2= ggplot(AGEGENRE, aes(x=age))+geom_density()+theme_minimal()+geom_vline(data=AGEGENRE, aes(xintercept=median(age)))+geom_vline(data=AGEGENRE, aes(xintercept=mean(age)),color="blue",linetype="dashed")+xlim(10, 90)
graphage
gausstest2
gausstest
AGE<-deputes[,c(22,24)]
# AGE<-AGE[-473,]
AGE<-na.omit(AGE)
medianage<-aggregate(AGE$age,by=list(AGE$`Groupe politique (abrégé)`),FUN="median")
vecteurmedianes<-medianage$x
# "Il faut sortir le NA il n'apporte aucune information et perturbe les données"
boxplotage<-ggplot(AGE, aes(x=`Groupe politique (abrégé)`,y=age, color=`Groupe politique (abrégé)`))+ geom_boxplot(show.legend = FALSE) + labs(title="Boite à moustache de l'age par parti politique",x="Parti politique",y="Age")+theme_minimal()
boxplotage
ageparparti<-aggregate(deputes$age,by=list(deputes$`Groupe politique (abrégé)`),FUN="mean")
sdageparparti<-aggregate(deputes$age,by=list(deputes$`Groupe politique (abrégé)`),FUN="sd")
sdageparparti$x=sdageparparti$x*sqrt(575/576)
ageparparti=merge(ageparparti, sdageparparti, by="Group.1")
meanage<-round(ageparparti$x.x,digits=0)
gagemoyenparparti<-ggplot(data = ageparparti, aes(x=Group.1,y=x.x, colour=Group.1))+geom_bar(stat="identity",aes(fill=Group.1),show.legend = FALSE, width=0.6)+labs(title="Age moyen par parti politique",x="Parti politique",y="Age moyen") + geom_text(aes(label=meanage),vjust=4,stat="identity",show.legend = FALSE,size=4.5,color="black")+ylim(0,70)+geom_errorbar(aes(ymin=meanage-x.y,ymax=meanage+x.y), color="black")+theme_minimal()
gagemoyenparparti
deputessanspierre <- subset(deputes, NOM!="VENTEAU")
mandatparparti<-aggregate(deputes$`Nombre de mandats`,by=list(deputes$`Groupe politique (abrégé)`),FUN="mean")
sdmandatparparti<-aggregate(deputes$`Nombre de mandats`,by=list(deputes$`Groupe politique (abrégé)`),FUN="sd")
sdmandatparparti$x=sdmandatparparti$x*sqrt(574/575)
mandatparparti=merge(mandatparparti, sdmandatparparti, by="Group.1")
meanmandat<-round(mandatparparti$x.x,digits=2)
gmandatparparti<-ggplot(data = mandatparparti, aes(x=Group.1,y=x.x, colour=Group.1))+geom_bar(stat="identity",aes(fill=Group.1),show.legend = FALSE, width=0.6)+labs(title="Nombre de mandats moyen par parti politique",x="Parti politique",y="Nombre de mandats moyen") + theme_minimal()+geom_errorbar(aes(ymin=meanmandat-x.y,ymax=meanmandat+x.y), color="black")+theme_minimal()
gmandatparparti
age_genre_parti<-aggregate(deputes$age,by=list(deputes$`Groupe politique (abrégé)`,deputes$Sexe),FUN="mean")
q <- ggplot(data=age_genre_parti, aes(x=Group.1, y=x, fill=Group.2)) +geom_bar(stat="identity", color="black", position=position_dodge())+geom_text(aes(label=round(x)), vjust=1.6, color="black", position = position_dodge(0.9), size=2.5) +labs(title = "Âge moyen par parti selon le genre", x="Parti politique", y="Âge moyen")+ theme_minimal() +scale_fill_discrete(name="Genre")
q
mandatpartisexe<-aggregate(deputes$`Nombre de mandats`,by=list(deputes$`Groupe politique (abrégé)`,deputes$Sexe),FUN="mean")
p <- ggplot(data=mandatpartisexe, aes(x=Group.1, y=x, fill=Group.2)) +geom_bar(stat="identity", color="black", position=position_dodge())+geom_text(aes(label=round(x,digits=2)), vjust=1.6, color="black", position = position_dodge(0.9), size=2.5) +labs(title = "Nombre de mandats moyen par parti selon le genre", x="Parti politique", y="Nombre de mandats moyen")+ theme_minimal() +scale_fill_discrete(name="Genre")
p
